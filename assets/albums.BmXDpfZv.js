import{u as H,D as Z,c as q,e as G,f as J}from"./app.BLsPbhY6.js";import{_ as Q}from"./YunPageHeader.vue_vue_type_script_setup_true_lang.DToOMU-r.js";import"./chunks/@vueuse/motion.DhjSK7p0.js";import"./chunks/dayjs.Csn7IZCt.js";import{a9 as tt,U as p,bb as f,aX as et,bf as at,Z as i,b3 as l,a6 as _,b_ as L,_ as s,Y as $,bB as st,bt as y,F as D,bd as P,aO as nt,X as ot,c0 as lt,c1 as it,bR as rt}from"./framework.Dgturmf_.js";import"./chunks/vue-router.C9-pOeEs.js";import"./chunks/vue-i18n.BhcMBmP7.js";import"./chunks/pinia.DxOMcE1w.js";/* empty css                    */import"./chunks/nprogress.B-150QKL.js";const ut={class:"px-6 py-8 w-full max-w-none"},ct={class:"calendar-actions mb-4 flex items-center justify-between"},dt={class:"text-lg font-medium whitespace-nowrap"},mt={key:0},pt={class:"calendar-grid"},vt={class:"day-num"},ft={key:1,class:"day-empty"},yt={class:"day-num"},gt={key:1,class:"albums-lock"},bt={class:"albums-lock-box"},ht={key:0,class:"albums-error"},_t="0921",Y="albums-unlocked",Ot=tt({__name:"albums",setup(wt){const S=H(),O=p(()=>S.value?.title||""),F=Z(),B=p(()=>F.value.filter(t=>t&&t.path&&t.path.startsWith("/albums")&&t.date)),I=p(()=>{const t={};return B.value.forEach(e=>{try{const m=new Date(e.date).toISOString().slice(0,10);t[m]||(t[m]=e)}catch{}}),t}),M=new Date,v=f(M.getFullYear()),n=f(M.getMonth()),T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function A(t,e){return new Date(t,e,1)}function W(t,e){return new Date(t,e+1,0)}const K=p(()=>new Date(v.value,n.value,1).toLocaleString(void 0,{year:"numeric",month:"long"})),R=p(()=>_t),g=f(""),c=f(""),b=f(!1);et(()=>{if(typeof window<"u")try{b.value=!!sessionStorage.getItem(Y)}catch{b.value=!1}});function x(){const t=String(R.value||"").trim();if(!t){c.value="未配置密码或密码为空";return}if(String(g.value||"").trim()===t){try{sessionStorage.setItem(Y,"1")}catch{}b.value=!0,c.value=""}else c.value="密码错误"}function U(){g.value="",c.value=""}function V(t,e){const d=A(t,e),m=W(t,e),h=d.getDay(),w=m.getDate(),o=[];for(let a=0;a<h;a++){const r=new Date(t,e,a-h+1);o.push({date:r,inMonth:!1,key:r.toISOString()})}for(let a=1;a<=w;a++){const r=new Date(t,e,a),u=`${t}-${String(e+1).padStart(2,"0")}-${String(a).padStart(2,"0")}`,C=I.value[u],k=new Date,z=`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`;o.push({date:r,inMonth:!0,key:r.toISOString(),hasAlbum:!!C,page:C,isToday:u===z})}for(;o.length%7!==0;){const a=o.length-1,r=o[a].date,u=new Date(r);u.setDate(u.getDate()+1),o.push({date:u,inMonth:!1,key:u.toISOString()})}return o}const E=p(()=>V(v.value,n.value));function N(){n.value===0?(n.value=11,v.value--):n.value--}function X(){n.value===11?(n.value=0,v.value++):n.value++}function j(){const t=new Date;v.value=t.getFullYear(),n.value=t.getMonth()}return(t,e)=>{const d=q,m=Q,h=at("RouterLink"),w=G,o=J;return l(),i(D,null,[_(w,null,{default:L(()=>[_(d),s("main",ut,[_(m,{title:O.value||t.$t("title.album"),icon:st(S).icon||"i-ri-hearts-line"},null,8,["title","icon"]),s("div",ct,[s("div",{class:"flex items-center gap-2"},[s("button",{class:"yun-icon-btn",onClick:N,"aria-label":"prev"},[...e[1]||(e[1]=[s("i",{class:"i-ri-arrow-left-line"},null,-1)])]),s("button",{class:"yun-icon-btn",onClick:X,"aria-label":"next"},[...e[2]||(e[2]=[s("i",{class:"i-ri-arrow-right-line"},null,-1)])]),s("button",{class:"yun-btn",onClick:j},"今天")]),s("div",dt,y(K.value),1)]),b.value?(l(),i("div",mt,[s("div",pt,[(l(),i(D,null,P(T,a=>s("div",{class:"weekday",key:a},y(a),1)),64)),(l(!0),i(D,null,P(E.value,a=>(l(),i("div",{key:a.key,class:nt(["day-cell",{"has-album":a.hasAlbum,other:!a.inMonth,today:a.isToday}])},[a.hasAlbum?(l(),ot(h,{key:0,to:a.page.path,class:"day-link","aria-label":"album"},{default:L(()=>[s("div",vt,y(a.date.getDate()),1),e[3]||(e[3]=s("span",{class:"album-badge","aria-label":"有相册"},null,-1))]),_:2},1032,["to"])):(l(),i("div",ft,[s("div",yt,y(a.date.getDate()),1)]))],2))),128))])])):(l(),i("div",gt,[s("div",bt,[e[4]||(e[4]=s("h3",null,"输入密码以查看相册",-1)),lt(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),type:"password",placeholder:"密码",class:"albums-input",onKeyup:it(x,["enter"])},null,544),[[rt,g.value]]),s("div",{class:"albums-lock-actions"},[s("button",{class:"yun-btn",onClick:x},"提交"),s("button",{class:"yun-btn yun-btn-ghost",onClick:U},"取消")]),c.value?(l(),i("p",ht,y(c.value),1)):$("v-if",!0)])]))]),$(" right column removed to hide article TOC ")]),_:1}),_(o)],64)}}});export{Ot as default};
